%!TEX root = ../thesis.tex

\usepackage{subfiles}
%Font
\usepackage{fourier}

\usepackage[usenames,table]{xcolor}
\definecolor{webgreen}{rgb}{0, 0.7, 0} % less intense green
\definecolor{webblue}{rgb}{0, 0, 0.6} % less intense blue
\definecolor{webred}{rgb}{0.5, 0, 0} % less intense red

\usepackage[pagebackref=true,bookmarks=true, bookmarksnumbered=true, bookmarksopen=false, colorlinks=true,
    linkcolor= blue, urlcolor = webred, citecolor= webgreen, filecolor = webred]{hyperref}
\hypersetup{pdftitle={Master's thesis},pdfauthor={Alberto Montes G\'omez},
pdfkeywords={},bookmarksnumbered,pdfstartview={FitV}}%

\usepackage{algpseudocode}
\usepackage{algorithm}
%\usepackage{algorithm2e}

\usepackage{pdflscape}
\usepackage{pdfpages}
\usepackage{multirow}

\usepackage{pgfplots}
\usepackage{tikz}
\usetikzlibrary{plotmarks}
\usetikzlibrary{patterns}
\usetikzlibrary{fit}
\usetikzlibrary{colorbrewer}
\usetikzlibrary{trees,shapes.geometric,arrows,positioning}
\usepgfplotslibrary{colorbrewer}
\pgfplotsset{compat=newest}
\pgfplotsset{cycle list/Set1-4}
\pgfplotsset{every axis/.append style={
  font=\footnotesize,
  thin,
  tick style={ultra thin}}}


\usepackage{amsmath}
\usepackage[english]{babel}

\usepackage[paperheight=297mm,paperwidth=210mm,top=35mm,left=36mm,height=235mm,width=148mm]{geometry}
\usepackage{graphicx}
\usepackage[export]{adjustbox}
\usepackage{cite}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Reset caligraphic font to default
\DeclareMathAlphabet{\mathcal}{OMS}{cmsy}{m}{n}

% Hyphenation
\tolerance=1000
\emergencystretch=10pt
\hyphenation{OSVOS}
\hyphenation{OnAVOS}

% References
\newcommand{\figref}[1]{Figure~\ref{fig:#1}}
\newcommand{\equref}[1]{Equation~\ref{eq:#1}}
\newcommand{\tabref}[1]{Table~\ref{tab:#1}}
\newcommand{\charef}[1]{Chapter~\ref{cha:#1}}
\newcommand{\secref}[1]{Section~\ref{sec:#1}}

% Cites
\newcommand{\davisboth}[0]{\cite{Perazzi2016, PontTuset2017}}
\newcommand{\davislast}[0]{\cite{PontTuset2017}}
\newcommand{\davisold}[0]{\cite{Perazzi2016}}
\newcommand{\pascal}[0]{\cite{Everingham10}}
\newcommand{\pytorch}[0]{\cite{paszke2017automatic}}
\newcommand{\hourglass}[0]{\cite{newell2016stacked}}
\newcommand{\mdnet}[0]{\cite{nam2016learning}}
\newcommand{\fastrcnn}[0]{\cite{girshick2015fast}}
\newcommand{\fasterrcnn}[0]{\cite{ren2015faster}}
\newcommand{\maskrcnn}[0]{\cite{he2017mask}}
\newcommand{\osvos}[0]{\cite{caelles2017one}}
\newcommand{\onavos}[0]{\cite{voigtlaender17BMVC}}
\newcommand{\deepml}[0]{\cite{fathi2017semantic}}
\newcommand{\maskrnn}[0]{\cite{NIPS2017_6636}}
\newcommand{\votchallenge}[0]{\cite{VOT_TPAMI}}
\newcommand{\metriclearning}[0]{\cite{balntas2016learning}}
\newcommand{\facenet}[0]{\cite{schroff2015facenet}}
\newcommand{\deeplab}[0]{\cite{chen2018deeplab}}
\newcommand{\pckmetric}[0]{\cite{sapp2013modec}}
\newcommand{\pspnet}[0]{\cite{zhao2017pyramid}}
\newcommand{\resnet}[0]{\cite{he2016deep}}
\newcommand{\dilatedconv}[0]{\cite{yu2015multi}}



% Coloring
\definecolor{rowblue}{RGB}{220,230,240}

% Figures
\newcommand{\instancesegmentation}[1]{%
  \begin{subfigure}{.33\textwidth}
    \centering
    \includegraphics[width=1\linewidth]{figures/instance_segmentation/overlay_#1.jpg}
  \end{subfigure}%
  \begin{subfigure}{.33\textwidth}
    \centering
    \includegraphics[width=1\linewidth]{figures/instance_segmentation/distance_map_#1.jpg}
  \end{subfigure}%
  \begin{subfigure}{.33\textwidth}
    \centering
    \includegraphics[width=1\linewidth]{figures/instance_segmentation/predicted_mask_#1.png}
  \end{subfigure}
}

\newcommand{\davissequencerow}[5]{%
  \begin{subfigure}{.25\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/davis_sequence/#1_#2.jpg}
    \subcaption{Frame #2}
  \end{subfigure}%
  \begin{subfigure}{.25\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/davis_sequence/#1_#3.jpg}
    \subcaption{Frame #3}
  \end{subfigure}%
  \begin{subfigure}{.25\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/davis_sequence/#1_#4.jpg}
    \subcaption{Frame #4}
  \end{subfigure}%
  \begin{subfigure}{.25\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/davis_sequence/#1_#5.jpg}
    \subcaption{Frame #5}
  \end{subfigure}%
}

\newcommand{\davisdatasetrow}[5]{%
  \begin{subfigure}{.20\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/davis_dataset/#1.jpg}
  \end{subfigure}%
  \begin{subfigure}{.20\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/davis_dataset/#2.jpg}
  \end{subfigure}%
  \begin{subfigure}{.20\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/davis_dataset/#3.jpg}
  \end{subfigure}%
  \begin{subfigure}{.20\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/davis_dataset/#4.jpg}
  \end{subfigure}%
  \begin{subfigure}{.20\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/davis_dataset/#5.jpg}
  \end{subfigure}%
}

\newcommand{\pascaldatasetrow}[5]{%
  \begin{subfigure}{.20\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/pascal_dataset/#1.jpg}
  \end{subfigure}%
  \begin{subfigure}{.20\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/pascal_dataset/#2.jpg}
  \end{subfigure}%
  \begin{subfigure}{.20\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/pascal_dataset/#3.jpg}
  \end{subfigure}%
  \begin{subfigure}{.20\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/pascal_dataset/#4.jpg}
  \end{subfigure}%
  \begin{subfigure}{.20\textwidth}
    \centering
    \includegraphics[width=.98\linewidth, height=.618\linewidth]{figures/pascal_dataset/#5.jpg}
  \end{subfigure}%
}

\newcommand{\showpascalpca}[1]{%
  \begin{subfigure}{.33\textwidth}
    \includegraphics[width=1.\linewidth,height=.618\linewidth]{figures/pascal/image/#1.jpg}
  \end{subfigure}%
  \begin{subfigure}{.33\textwidth}
    \includegraphics[width=1.\linewidth,height=.618\linewidth]{figures/pascal/annotation/#1.png}
  \end{subfigure}%
  \begin{subfigure}{.33\textwidth}
    \includegraphics[width=1.\linewidth,height=.618\linewidth]{figures/pascal/pca/#1.jpg}
  \end{subfigure}
}

\newcommand{\showpascaldistancemap}[1]{%
  \begin{subfigure}{.33\textwidth}
    \includegraphics[width=1.\linewidth,height=.618\linewidth]{figures/pascal/image/#1.jpg}
  \end{subfigure}%
  \begin{subfigure}{.33\textwidth}
    \includegraphics[width=1.\linewidth,height=.618\linewidth]{figures/pascal/distance_map/#1_1.jpg}
  \end{subfigure}%
  \begin{subfigure}{.33\textwidth}
    \includegraphics[width=1.\linewidth,height=.618\linewidth]{figures/pascal/predicted_mask/#1_1.png}
  \end{subfigure}

  \begin{subfigure}{.33\textwidth}
    \includegraphics[width=1.\linewidth,height=.618\linewidth]{figures/pascal/annotation/#1.png}
  \end{subfigure}%
  \begin{subfigure}{.33\textwidth}
    \includegraphics[width=1.\linewidth,height=.618\linewidth]{figures/pascal/distance_map/#1_2.jpg}
  \end{subfigure}%
  \begin{subfigure}{.33\textwidth}
    \includegraphics[width=1.\linewidth,height=.618\linewidth]{figures/pascal/predicted_mask/#1_2.png}
  \end{subfigure}
  \\[1 em]
}

\newcommand{\showdavisresults}[1]{%
  % \rotatebox{90}{\centering \hspace{5.5mm}\vphantom{tg}#1}
  \begin{subfigure}{.02\textwidth}
    \rotatebox{90}{\centering \fontsize{5}{6}\selectfont #1}
  \end{subfigure}%
  \begin{subfigure}{.98\textwidth}
    \includegraphics[width=.20\linewidth,height=.1236\linewidth]{figures/davis/results/#1_1.jpg}%
    \includegraphics[width=.20\linewidth,height=.1236\linewidth]{figures/davis/results/#1_2.jpg}%
    \includegraphics[width=.20\linewidth,height=.1236\linewidth]{figures/davis/results/#1_3.jpg}%
    \includegraphics[width=.20\linewidth,height=.1236\linewidth]{figures/davis/results/#1_4.jpg}%
    \includegraphics[width=.20\linewidth,height=.1236\linewidth]{figures/davis/results/#1_5.jpg}
  \end{subfigure}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Legacy
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{collcell}
\usepackage{booktabs}

\usepackage{etex}
\input xy
\xyoption{all}



\usepackage[compact]{titlesec}
%\titlespacing{\section}{0pt}{*0}{*0}
\titlespacing{\subsection}{0pt}{8pt}{0pt}
%\titlespacing{\subsubsection}{0pt}{*0}{*0}


\setlength{\parskip}{0.7\baselineskip}
\setlength{\parindent}{0pt}
\renewcommand{\baselinestretch}{1}

\usepackage{rotating}
% \usepackage{pifont}


\usepackage{paralist}

%********Capcalera i peu de pagina**********
\pagestyle{myheadings}
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}


%% Change chapter style
\usepackage{calc}
\definecolor{chaptercolor}{gray}{0.8}
% helper macros
\newcommand\numlifter[1]{\raisebox{-2cm}[0pt][0pt]{\smash{#1}}}
\newcommand\numindent{\kern37pt}
\newlength\chaptertitleboxheight
\makechapterstyle{hansen}{
  \renewcommand\printchaptername{\raggedleft}
  \renewcommand\printchapternum{%
    \begingroup%
    \leavevmode%
    \chapnumfont%
    \strut%
    \numlifter{\thechapter}%
    \numindent%
\endgroup%
}
  \renewcommand*{\printchapternonum}{%
    \vphantom{\begingroup%
      \leavevmode%
      \chapnumfont%
      \numlifter{\vphantom{9}}%
      \numindent%
      \endgroup}
    \afterchapternum}
  \setlength\midchapskip{0pt}
  \setlength\beforechapskip{0.5\baselineskip}
  \setlength{\afterchapskip}{3\baselineskip}
  \renewcommand\chapnumfont{%
    \fontsize{4cm}{5mm}%
    \bfseries%
    %\sffamily%
    \color{chaptercolor}%
  }
  \renewcommand\chaptitlefont{%
    \normalfont%
    \huge%
    \bfseries%
    \raggedleft%
  }%
  \settototalheight\chaptertitleboxheight{%
    \parbox{\textwidth}{\chaptitlefont \strut bg\\bg\strut}}
  \renewcommand\printchaptertitle[1]{%
    \parbox[t][\chaptertitleboxheight][t]{\textwidth}{%
      %\microtypesetup{protrusion=false}% add this if you use microtype
      \chaptitlefont\strut ##1\strut}%
}}
\chapterstyle{hansen}
\aliaspagestyle{chapter}{empty}


\usepackage{caption}
\usepackage{subcaption}
\newcommand{\subcaptationspace}{\captionsetup{skip=2.5pt} }
\newcommand{\captationspace}{\captionsetup{skip=2.5pt} }
\newcommand{\subfigurespace}{\par\medskip}%\bigskip or \medskip
\newcommand{\ToDo}[1]{{\small\color{cyan}[ToDo]: #1}}
